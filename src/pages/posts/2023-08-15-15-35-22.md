---
templateKey: blog-post
title: eslint を使って、関数の全てのパスで値を返すことを強制する
date: 2023-08-15T06:21:25.497Z
tags:
  - javascript
  - eslint
---

関数で値を返すための return が必要か否か？みたいなネタを見た気がするけど、それとは関係なく、「ソフトウェアの操作がとある条件を満たしたときに機能が動作しない。」という不具合を起こしてしまい、原因を調べていたら、 **関数内の処理が特定の条件のときに return が書かれておらず、期待した値が返却されず機能が動作しない** というものだった。


コードにするとこんな感じ。

```javascript
const func = (flg) => {
  if (flg) {
    console.log('success');
    return 1;
  } else {
    console.log('failed');
  }
}

if func(condition) == 1 || func(condition) == 2) {
  // 期待する処理
} else {
  // 期待しない処理
}
```

``console.log('failed')`` の次で ``return 2`` するのを忘れていたという不具合。

あーこれ Lint (by Angular 12)で教えてくれないのかー。と残念に思いつつ、そのオプションを調べてみた。

すると、

- [consistent-return - ESLint - Pluggable JavaScript Linter](https://eslint.org/docs/latest/rules/consistent-return)

が該当する模様。

早速設定に追加してみると、期待どおり ``func`` でエラーにしてくれた。

![image.png](https://raw.githubusercontent.com/amay077/blog2023/main/src/img/2023-08-15-01H7VYCJB0HEPRBREA7DKZSVCK.png)


ESLint の Playground で試した結果が↓。

- [ESLint Playground - ESLint - Pluggable JavaScript Linter](https://eslint.org/play/#eyJ0ZXh0IjoiY29uc3QgZnVuYyA9IChmbGcpID0+IHtcbiAgaWYgKGZsZykge1xuICAgIGNvbnNvbGUubG9nKCdzdWNjZXNzJyk7XG4gICAgcmV0dXJuIDA7XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS5sb2coJ2ZhaWxlZCcpO1xuICB9XG59XG5cbmNvbnN0IHN0czEgPSBmdW5jKHRydWUpO1xuY29uc3Qgc3RzMiA9IGZ1bmMoZmFsc2UpO1xuY29uc29sZS5sb2coc3RzMSwgc3RzMik7Iiwib3B0aW9ucyI6eyJlbnYiOnsiZXM2Ijp0cnVlLCJicm93c2VyIjp0cnVlfSwicnVsZXMiOnsiY29uc3RydWN0b3Itc3VwZXIiOlsiZXJyb3IiXSwiZm9yLWRpcmVjdGlvbiI6WyJlcnJvciJdLCJnZXR0ZXItcmV0dXJuIjpbImVycm9yIl0sIm5vLWFzeW5jLXByb21pc2UtZXhlY3V0b3IiOlsiZXJyb3IiXSwibm8tY2FzZS1kZWNsYXJhdGlvbnMiOlsiZXJyb3IiXSwibm8tY2xhc3MtYXNzaWduIjpbImVycm9yIl0sIm5vLWNvbXBhcmUtbmVnLXplcm8iOlsiZXJyb3IiXSwibm8tY29uZC1hc3NpZ24iOlsiZXJyb3IiXSwibm8tY29uc3QtYXNzaWduIjpbImVycm9yIl0sIm5vLWNvbnN0YW50LWNvbmRpdGlvbiI6WyJlcnJvciJdLCJuby1jb250cm9sLXJlZ2V4IjpbImVycm9yIl0sIm5vLWRlYnVnZ2VyIjpbImVycm9yIl0sIm5vLWRlbGV0ZS12YXIiOlsiZXJyb3IiXSwibm8tZHVwZS1hcmdzIjpbImVycm9yIl0sIm5vLWR...lcyI6WyJlcnJvciJdLCJuby1zZWxmLWFzc2lnbiI6WyJlcnJvciJdLCJuby1zZXR0ZXItcmV0dXJuIjpbImVycm9yIl0sIm5vLXNoYWRvdy1yZXN0cmljdGVkLW5hbWVzIjpbImVycm9yIl0sIm5vLXNwYXJzZS1hcnJheXMiOlsiZXJyb3IiXSwibm8tdGhpcy1iZWZvcmUtc3VwZXIiOlsiZXJyb3IiXSwibm8tdW5kZWYiOlsiZXJyb3IiXSwibm8tdW5leHBlY3RlZC1tdWx0aWxpbmUiOlsiZXJyb3IiXSwibm8tdW5yZWFjaGFibGUiOlsiZXJyb3IiXSwibm8tdW5zYWZlLWZpbmFsbHkiOlsiZXJyb3IiXSwibm8tdW5zYWZlLW5lZ2F0aW9uIjpbImVycm9yIl0sIm5vLXVuc2FmZS1vcHRpb25hbC1jaGFpbmluZyI6WyJlcnJvciJdLCJuby11bnVzZWQtbGFiZWxzIjpbImVycm9yIl0sIm5vLXVudXNlZC12YXJzIjpbImVycm9yIl0sIm5vLXVzZWxlc3MtYmFja3JlZmVyZW5jZSI6WyJlcnJvciJdLCJuby11c2VsZXNzLWNhdGNoIjpbImVycm9yIl0sIm5vLXVzZWxlc3MtZXNjYXBlIjpbImVycm9yIl0sIm5vLXdpdGgiOlsiZXJyb3IiXSwicmVxdWlyZS15aWVsZCI6WyJlcnJvciJdLCJ1c2UtaXNuYW4iOlsiZXJyb3IiXSwidmFsaWQtdHlwZW9mIjpbImVycm9yIl0sImFycmF5LWJyYWNrZXQtbmV3bGluZSI6WyJlcnJvciJdLCJjb25zaXN0ZW50LXJldHVybiI6WyJlcnJvciJdfSwicGFyc2VyT3B0aW9ucyI6eyJlY21hRmVhdHVyZXMiOnt9LCJlY21hVmVyc2lvbiI6ImxhdGVzdCIsInNvdXJjZVR5cGUiOiJzY3JpcHQifX19)

これはプロジェクト開始時に設定しておくようにしよう。 


